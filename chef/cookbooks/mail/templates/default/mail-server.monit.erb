check process dovecot with pidfile /var/run/dovecot/master.pid
  start program = "/usr/sbin/service dovecot start"
  stop program  = "/usr/sbin/service dovecot stop"
  if failed port 143 protocol imap with timeout 15 seconds for 3 cycles then restart
  if failed port 993 type tcpssl protocol imap with timeout 15 seconds for 3 cycles then restart
  if failed port 110 protocol pop with timeout 15 seconds for 3 cycles then restart
  if failed port 995 type tcpssl protocol pop with timeout 15 seconds for 3 cycles then restart
  if 3 restarts within 5 cycles then timeout

check process amavis with pidfile /var/run/amavis/amavisd.pid
  start program = "/usr/sbin/service amavis start"
  stop program  = "/usr/sbin/service amavis stop"
  if failed port 10024 protocol smtp with timeout 15 seconds for 3 cycles then restart
  if 3 restarts within 5 cycles then timeout

check process spamassassin with pidfile /var/run/spamd.pid
  start program = "/usr/sbin/service spamassassin start"
  stop program  = "/usr/sbin/service spamassassin stop"
  if failed port 783 with timeout 15 seconds for 3 cycles then restart
  if 3 restarts within 5 cycles then timeout

check process clamav-daemon with pidfile /var/run/clamav/clamd.pid
  start program = "/usr/sbin/service clamav-daemon start"
  stop program  = "/usr/sbin/service clamav-daemon stop"
  if 3 restarts within 5 cycles then timeout

check process clamav-freshclam with pidfile /var/run/clamav/freshclam.pid
  start program = "/usr/sbin/service clamav-freshclam start"
  stop program  = "/usr/sbin/service clamav-freshclam stop"
  if 3 restarts within 5 cycles then timeout

check process postgrey with pidfile /var/run/postgrey.pid
  start program = "/usr/sbin/service postgrey start"
  stop program  = "/usr/sbin/service postgrey stop"
  if failed port 10023 with timeout 15 seconds for 3 cycles then restart
  if 3 restarts within 5 cycles then timeout
